import csv
import os
import sys

def process_csv_file(file_path):
    with open(file_path, 'r', newline='', encoding='utf-8') as infile:
        reader = csv.reader(infile)
        rows = list(reader)

    if not rows:
        return

    header = rows[0]

    if len(header) > 0 and header[0].strip().lower() == "order":
        print("Updating:", file_path)

        updated_rows = []

        for row in rows:
            if len(row) > 1:
                updated_rows.append(row[1:])
            else:
                updated_rows.append([])

        with open(file_path, 'w', newline='', encoding='utf-8') as outfile:
            writer = csv.writer(outfile)
            writer.writerows(updated_rows)


def recurse_directory(root_dir):
    for root, dirs, files in os.walk(root_dir):
        for file in files:
            if file.lower().endswith(".csv"):
                full_path = os.path.join(root, file)
                process_csv_file(full_path)


if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python script.py <directory>")
    else:
        recurse_directory(sys.argv[1])
